<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<title></title>
<link rel="stylesheet" type="text/css" th:href="@{/css/common.css}"/>
<link rel="stylesheet" type="text/css" th:href="@{/css/userRegist.css}"/>
<link rel="stylesheet" type="text/css" th:href="@{/css/animate.css}"/>
<script th:src="@{http://libs.baidu.com/jquery/2.0.0/jquery.min.js}"></script>
<script type="text/javascript" th:src="@{/css/正确/iconfont.js}"></script>
<style type="text/css">
.input_login {
	-web-kit-appearance: none;
	-moz-appearance: none;
	font-size: 14px;
	/*设置输入框中字体的大小*/
	height: 40px;
	/*设置输入框的高度*/
	border-radius: 5px;
	/*设置输入框的圆角的大小*/
	border: 1px solid #c8cccf;
	/*设置输入框边框的粗细和颜色*/
	color: #986655;
	/*设置输入框中文字的颜色 */
	outline: 0;
	/*将输入框点击的时候出现的边框去掉*/
	text-align: center;
	/*设置输入框中文字的位置*/
	/*display: block;*/
	/*将输入框设置为块级元素*/
	width: 310px;
	margin-top: 20px;
}

#accountValid {
	position: absolute;
	font-size: 14px;
	color: red;
	top: 30px;
	left: 315px;
	width: 300px;
	text-align: left;
}

#passwordValid1 {
	position: absolute;
	font-size: 14px;
	color: red;
	top: 30px;
	left: 315px;
	width: 300px;
	text-align: left;
}

#passwordValid2 {
	position: absolute;
	font-size: 14px;
	color: red;
	top: 30px;
	left: 315px;
	width: 300px;
	text-align: left;
}

#emailValid {
	position: absolute;
	font-size: 14px;
	color: red;
	top: 30px;
	left: 315px;
	width: 300px;
	text-align: left;
}

.form_login {
	position: relative;
	margin-top: 20px;
}

.inp_info {
	width: 310px;
	margin: auto;
	position: relative;
}

.input_item {
	position: relative;
}

.iconD {
	width: 20px;
	height: 20px;
	vertical-align: -0.15em;
	fill: currentColor;
	overflow: hidden;
	margin-top: 0px;
}

.iconl {
	width: 20px;
	height: 20px;
	vertical-align: -0.15em;
	fill: currentColor;
	overflow: hidden;
	margin-top: 4px;
}

/*滑块*/
.drag {
	width: 310px;
	height: 32px;
	line-height: 32px;
	position: relative;
	margin: 0 auto;
	margin-top: 10px;
}

.bg {
	width: 40px;
	height: 100%;
	position: absolute;
	background-color: white;
}

.text {
	position: absolute;
	width: 100%;
	height: 100%;
	text-align: center;
	user-select: none;
	font-size: 12px;
	color: #9c9c9c;
	background-color: white;
}

.btn {
	width: 42px;
	height: 30px;
	position: absolute;
	border: 1px solid #ccc;
	cursor: move;
	font-family: "宋体";
	text-align: center;
	background-color: #fff;
	user-select: none;
	color: #666;
}
</style>
</head>
<body>
	<div class="login">
		<!--登录标题-->
		<span class="login_font">注册</span> <!--登录表单-->
		<div class="form_login">
			<form th:action="@{/user/regist}" method="post">
				<div class="inp_info">
					<div class="input_item">
						<input type="text" name="reg_account" id="reg_account" class="input_login" placeholder="请输入账号" /> 
						<span id="accountValid"></span><br />
					</div>
					<div class="input_item">
						<input type="password" name="reg_pass" id="reg_pass"
							class="input_login" placeholder="请输入密码" /> <span
							id="passwordValid1"></span><br />
					</div>
					<div class="input_item">
						<input type="password" name="reg_pass2" id="reg_pass2"
							class="input_login" placeholder="确认	密码" /> <span
							id="passwordValid2"></span><br />
					</div>
					<div class="input_item">
						<input type="text" name="reg_email" id="reg_email"
							class="input_login" placeholder="请输入邮箱" /> <span id="emailValid"></span><br />
					</div>
					<div class="drag" id="reg_hk">
						<div class="bg"></div>
						<div class="text">请拖动滑块解锁</div>
						<div class="btn">&gt;&gt;</div>
					</div>
				</div>
				<input type="hidden" id="b1" value="" /> 
				<input type="hidden" id="i1" value="1" /> 
				<input type="hidden" id="i2" value="1" /> 
				<input type="hidden" id="i3" value="1" /> 
				<input type="hidden" id="i4" value="1" />
				<input type="hidden" name="validHk" id="validHk" value="" />
				<div class="tip">
					注册 OnePlus，即表示你同意 OnePlus 的 <span class="tiaokuan"> 使用条款 </span> 和
					<span class="tiaokuan"> 隐私政策 </span>
				</div>
				<input type="submit" value="创建账号" id="login_btn" />
			</form>
		</div>
		<!--其他方式登录-->
		<div class="login_others">
			<div style="height: 20px; width: 310px;"></div>
			<!--登录按钮-->
			<div class="login_link" onclick="to_Login()">登录</div>
			<div style="height: 100px; width: 310px;"></div>
		</div>
	</div>
</body>
<script th:inline="javascript">
/*<![CDATA[*/
	/* 跳转 */
	function to_Login(){
		alert(1);
		location.href="/user/touserLogin";
	}
	//账号验证
	$("#reg_account").change(function() {
		validAccount()
	})
	function validAccount() {
		var reg = /^(?=.*?[a-z)(?=.*>[A-Z])(?=.*?[0-9])[a-zA_Z0-9]{6,18}$/;
		if (reg.test($("#reg_account").val()) == false) {
			$('#accountValid').text("字母开头，包含数字，长度为6-18").show().addClass('animated shake');
			setTimeout(function() {
				$('#accountValid').removeClass('animated shake');
			}, 1000);
		} else {
			var reg_account = $("#reg_account").val();
			$.ajax({
				url : "/user/validUsernname",
				type : "GET",
				data : {
					reg_account : reg_account
				},
				dataType : "json",
				success : function(data) {
				$("#b1").val(data);
				if (data) {//可用
					$("#i1").val(0);
					$('#accountValid').text("").append('<svg class="iconD" aria-hidden="true"><use xlink:href="#icon-zhengque3"></use></svg>');
					} else {
						$("#i1").val(1);
						$('#accountValid').text("已被注册").show().addClass('animated shake');
						setTimeout(function() {
									$('#accountValid').removeClass('animated shake');
						}, 1000);
					}
				}
			});
			var x = $("#b1").val();
			return x;
		}
	}
	//密码验证
	$("#reg_pass").change(function() {
		validPass1()
	})
	function validPass1() {
		var pwd = $("#reg_pass").val()
		/*是否包含数字、字母、长度等限制条件  */
		var reg = /^(?=.*?[a-z)(?=.*>[A-Z])(?=.*?[0-9])[a-zA_Z0-9]{6,18}$/;
		if (reg.test(pwd) == false) {
			$("#i2").val(1);
			$('#passwordValid1').text("密码必须以字母开头，包含数字长度为6-18").show().addClass(
					'animated shake');
			setTimeout(function() {
				$('#passwordValid1').removeClass('animated shake');
			}, 1000);
		} else {
			$("#i2").val(0);
			$('#passwordValid1').text("").append('<svg class="iconD" aria-hidden="true"><use xlink:href="#icon-zhengque3"></use></svg>');
		}
	}
	//确认密码验证
	$("#reg_pass2").change(function() {
		validPass2()
	})
	function validPass2() {
		var pwd = $("#reg_pass").val();
		var pwd2 = $("#reg_pass2").val();
		if (pwd != pwd2) {
			$("#i3").val(1);
			$('#passwordValid2').text("两次密码不一致").show().addClass('animated shake');
			setTimeout(function() {
				$('#passwordValid2').removeClass('animated shake');
			}, 1000);

		} else {
			$("#i3").val(0);
			$('#passwordValid2').text("").append('<svg class="iconD" aria-hidden="true"><use xlink:href="#icon-zhengque3"></use></svg>');
		}
	}
	//邮箱验证
	$("#reg_email").change(function() {
		validEmail()
	})
	function validEmail() {
		var reg = /^\w+@\w+(\.[a-zA-Z]{2,3}){1,2}$/;
		var email = $("#reg_email").val()
		if (reg.test(email) == false) {
			$("#i4").val(1);
			$('#emailValid').text("请输入正确邮箱").show().addClass('animated shake');
			setTimeout(function() {
				$('#emailValid').removeClass('animated shake');
			}, 1000);

		} else {
			$("#i4").val(0);
			$('#emailValid')
					.text("")
					.append(
							'<svg class="iconD" aria-hidden="true"><use xlink:href="#icon-zhengque3"></use></svg>');
		}
	}
	$("form").submit(
			function() {
				validAccount();
				//先判断是否为空reg_account
				if ($("#reg_account").val() == "") {
					$('#accountValid').text("请输入账号").show().addClass(
							'animated shake');
					setTimeout(function() {
						$('#accountValid').removeClass('animated shake');
					}, 1000);
					return false;
				} else if ($("#reg_pass").val() == "") {
					$('#passwordValid1').text("请输入密码").show().addClass(
							'animated shake');
					setTimeout(function() {
						$('#passwordValid1').removeClass('animated shake');
					}, 1000);
					return false;
				} else if ($("#reg_pass2").val() == "") {
					$('#passwordValid2').text("请输入确认密码").show().addClass(
							'animated shake');
					setTimeout(function() {
						$('#passwordValid2').removeClass('animated shake');
					}, 1000);
					return false;
				} else if ($("#reg_email").val() == "") {
					$('#emailValid').text("请输入邮箱").show().addClass(
							'animated shake');
					setTimeout(function() {
						$('#emailValid').removeClass('animated shake');
					}, 1000);
					return false;
				}

				//判断上面填的是否正确
				if ($("#i1").val() != 0) {
					$('#accountValid').text("请输入正确的账号").show().addClass(
							'animated shake');
					setTimeout(function() {
						$('#accountValid').removeClass('animated shake');
					}, 1000);
					return false;
				}
				if ($("#i2").val() != 0) {
					$('#passwordValid1').text("请输入正确的密码").show().addClass(
							'animated shake');
					setTimeout(function() {
						$('#passwordValid1').removeClass('animated shake');
					}, 1000);
					return false;
				} else if ($("#i3").val() != 0) {
					$('#passwordValid2').text("两次密码不一致").show().addClass(
							'animated shake');
					setTimeout(function() {
						$('#passwordValid2').removeClass('animated shake');
					}, 1000);
					return false;
				} else if ($("#i4").val() != 0) {
					$('#emailValid').text("请输入正确的邮箱").show().addClass(
							'animated shake');
					setTimeout(function() {
						$('#emailValid').removeClass('animated shake');
					}, 1000);
					return false;
				}
				//滑块验证
				var hk = $("#validHk").val();
				if (hk != "1") {
					$('#reg_hk').addClass('animated shake');
					setTimeout(function() {
						$('#reg_hk').removeClass('animated shake');
					}, 1000);
					return false;
				} else {
					validAccount();
				}

			});
	 /*]]>*/
</script>
<script>
/*<![CDATA[*/
	//一、定义一个获取DOM元素的方法
	var $a = function(selector) {
		return document.querySelector(selector);
	}, box = $a(".drag"), //容器
	bg = $a(".bg"), //背景
	text = $a(".text"), //文字
	btn = $a(".btn"), //滑块
	success = false, //是否通过验证的标志
	distance = box.offsetWidth - btn.offsetWidth; //滑动成功的宽度（距离）

	//二、给滑块注册鼠标按下事件
	btn.onmousedown = function(e) {

		//1.鼠标按下之前必须清除掉后面设置的过渡属性
		btn.style.transition = "";
		bg.style.transition = "";
		//说明：clientX 事件属性会返回当事件被触发时，鼠标指针向对于浏览器页面(或客户区)的水平坐标。
		//2.当滑块位于初始位置时，得到鼠标按下时的水平位置
		var e = e || window.event;
		var downX = e.clientX;
		//三、给文档注册鼠标移动事件
		document.onmousemove = function(e) {
			var e = e || window.event;
			//1.获取鼠标移动后的水平位置
			var moveX = e.clientX;
			//2.得到鼠标水平位置的偏移量（鼠标移动时的位置 - 鼠标按下时的位置）
			var offsetX = moveX - downX;
			//3.在这里判断一下：鼠标水平移动的距离 与 滑动成功的距离 之间的关系
			if (offsetX > distance) {
				offsetX = distance; //如果滑过了终点，就将它停留在终点位置
			} else if (offsetX < 0) {
				offsetX = 0; //如果滑到了起点的左侧，就将它重置为起点位置
			}
			//4.根据鼠标移动的距离来动态设置滑块的偏移量和背景颜色的宽度
			btn.style.left = offsetX + "px";
			bg.style.width = offsetX + "px";

			//如果鼠标的水平移动距离 = 滑动成功的宽度
			if (offsetX == distance) {
				//1.设置滑动成功后的样式
				text.innerHTML = "验证通过";
				text.style.color = "#fff";
				btn.innerHTML = '<svg class="iconl" aria-hidden="true"><use xlink:href="#icon-zhengque3"></use></svg>';
				btn.style.color = "green";
				bg.style.backgroundColor = "lightgreen";
				//2.设置滑动成功后的状态
				success = true;
				//成功后，清除掉鼠标按下事件和移动事件（因为移动时并不会涉及到鼠标松开事件）
				btn.onmousedown = null;
				document.onmousemove = null;
				//3.成功解锁后的回调函数
				setTimeout(function() {
					$("#validHk").attr("value", '1')
				}, 
				100);
			}
		}

		//四、给文档注册鼠标松开事件
		document.onmouseup = function(e) {
			//如果鼠标松开时，滑到了终点，则验证通过
			if (success) {
				return;
			} else {
				//反之，则将滑块复位（设置了1s的属性过渡效果）
				btn.style.left = 0;
				bg.style.width = 0;
				btn.style.transition = "left 1s ease";
				bg.style.transition = "width 1s ease";
			}
			//只要鼠标松开了，说明此时不需要拖动滑块了，那么就清除鼠标移动和松开事件。
			document.onmousemove = null;
			document.onmouseup = null;
		}

	}
	  /*]]>*/
</script>

</html>